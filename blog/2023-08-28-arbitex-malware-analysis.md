---
slug: arbitex-malware-analysis
title: Unveiling the Layers - A Comprehensive Malware Analysis of a Malicious React App
author: NomanAziz
author_title: Full Stack Web3 Developer | DevSecOps Engineer
author_url: https://linkedin.com/in/noman-aziz
author_image_url: /img/nomanaziz2.jpeg
image: https://res.cloudinary.com/dy09028kh/image/upload/v1684004825/Redux_Toolkit_vals3w.png
tags: [MalwareAnalysis, CyberSecurity]
---

import useDocusaurusContext from '@docusaurus/useDocusaurusContext';
import Giscus from "@giscus/react";

In this blog post, we will conduct a thorough malware analysis of a malicious React app that was referenced in my recent [LinkedIn post](https://www.linkedin.com/posts/noman-aziz_freelancing-softwaredevelopment-cybersecurity-activity-7098294971241263104-HCau?utm_source=share&utm_medium=member_desktop). All relevant files for this analysis are conveniently hosted within my [GitHub repository](https://github.com/Noman-Aziz/ARBITEX-Malware-Analysis). For understanding each file's contents and purpose, I encourage you to refer to the `README` document.

<!--truncate-->

## The main() function

At first glance, the project appears to be a typical React app. However, a closer examination of the `package.json` start script reveals that it executes a Node.js script named `setupTests.js`. Curiously, it may seem that this script is intended for running test cases related to the project, but in reality, its purpose is quite different.

![package-json](https://res.cloudinary.com/dy09028kh/image/upload/v1693201594/arbitex-malware-analysis/1_mkhv5z.png)

Taking a closer look at this file, the code might appear somewhat garbled. Fortunately, with the Prettier extension installed, we can make the code more readable.

![before-prettier](https://res.cloudinary.com/dy09028kh/image/upload/v1693201594/arbitex-malware-analysis/2_bscz6n.png)
![after-prettier](https://res.cloudinary.com/dy09028kh/image/upload/v1693201595/arbitex-malware-analysis/3_jeqfnr.png)

With improved formatting, the code begins to make sense, yet it remains obfuscated and minified. The process of de-obfuscating and un-minifying proved to be a challenging yet enjoyable task, reminiscent of my Capture The Flag (CTF) days. The end result is a decoded file named `setupTestsDecoded.js`.

![decoded-file](https://res.cloudinary.com/dy09028kh/image/upload/v1693201594/arbitex-malware-analysis/4_jduyvi.png)

Subsequent parts of this blog will delve into various functionalities of this code, so stay tuned for further exploration. As for the main() function, this script appears to invoke two functions at intervals of 10 minutes.

![main-ftn](https://res.cloudinary.com/dy09028kh/image/upload/v1693201594/arbitex-malware-analysis/5_ruq7x7.png)

## Crypto Wallet Extensions

This section delves into the first significant task executed by this malware: targeting crypto wallet extensions within Chromium-based browsers. The malware appears to have a predefined list of extensions it targets, all of which pertain to crypto wallets. These extensions are highlighted below.

![target-extensions](https://res.cloudinary.com/dy09028kh/image/upload/v1693205611/arbitex-malware-analysis/6_dokgze.png)

:::tip
Curious about how extension names were decoded from their IDs? Utilize this URL: `https://chrome.google.com/webstore/detail/TEXT/<extension-id>`. Replace `<extension-id>` with the respective extension's ID, and you'll be redirected to its Chrome Web Store page.
:::

The malware's operation revolves around compiling browser data paths specific to Chrome, Brave, and Opera browsers across various operating systems, including Windows, Linux, and MacOS. The collected data paths are presented below.

![browser-paths](https://res.cloudinary.com/dy09028kh/image/upload/v1693205611/arbitex-malware-analysis/7_fivi5d.png)

The malware meticulously traverses up to 200 created browser profiles, endeavoring to extract content from `.ldb` and `.log` files associated with these extensions. Additionally, it targets the Solana wallet configuration file. The harvested data is then transmitted to a server via POST request.

![extension-code](https://res.cloudinary.com/dy09028kh/image/upload/v1693205611/arbitex-malware-analysis/8_ikigw6.png)

:::tip
For those unfamiliar, these files refers to Google's LevelDB filesystem, utilized by Chromium browsers to store extension and browser data. For a comprehensive understanding of this filesystem, refer to this enlightening [blog post](https://dfir.blog/deciphering-browser-hieroglyphics-leveldb-filesystem). The author elaborates on the topic and provides an open-source tool named [hindsight](https://github.com/obsidianforensics/hindsight) that can efficiently extract and export LevelDB data to Excel spreadsheets.
:::

### Metamask Vault Decryption

A pertinent question arises: why is this malware targeting and extracting crypto wallet `.ldb` and `.log` files? What do these files contain, and are they not encrypted to safeguard sensitive data? To address these inquiries, I will consider the case of the MetaMask extension, which shares a comparable approach with other extensions.

For insight, refer to this informative [article](https://support.metamask.io/hc/en-us/articles/360018766351-How-to-use-the-Vault-Decryptor-with-the-MetaMask-Vault-Data) provided by MetaMask. This resource outlines a mechanism that facilitates the acquisition of wallet seed phrases via specific `.ldb` or `.log` files. In parallel, MetaMask has introduced a [vault decryptor tool](https://metamask.github.io/vault-decryptor/) designed to automate this process. The tool requires the appropriate file and the MetaMask vault password you initially established during the setup.

![decrypter-tool](https://res.cloudinary.com/dy09028kh/image/upload/v1693205613/arbitex-malware-analysis/9_qqbbty.png)

You might then inquire: how does the malware gain access to our secret password? In addition to employing brute force tactics, the malware also implants a Remote Access Trojan (R.A.T) onto the system. This R.A.T logs keystrokes, steals clipboard contents, and seizes various files that will be thoroughly explored in the subsequent R.A.T section of this blog.

## Windows Browser Passwords Data

### The DLL File
https://www.sobyte.net/post/2022-02/communicate-with-cpp-code-in-node/


## The Python scripts
p2.zip

### System Information & Geo-location Data

### Browser Passwords & Credit Card Data

### The Remote Access Trojan (R.A.T)


## Closing remarks



<br/>
<h2>Comments</h2>
<Giscus
id="comments"
repo="Noman-Aziz/Blogs"
repoId="R_kgDOIAF3tw"
category="General"
categoryId="DIC_kwDOIAF3t84CRfxZ"
mapping="title"
term="Comments"
reactionsEnabled="1"
emitMetadata="0"
inputPosition="top"
theme="preferred_color_scheme"
lang="en"
loading="lazy"
crossorigin="anonymous"
    />
